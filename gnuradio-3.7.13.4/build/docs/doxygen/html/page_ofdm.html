<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>GNU Radio Manual and C++ API Reference: OFDM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="gnuradio_logo_icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">GNU Radio Manual and C++ API Reference
   &#160;<span id="projectnumber">3.7.13.4</span>
   </div>
   <div id="projectbrief">The Free &amp; Open Software Radio Ecosystem</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_ofdm.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(13)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">OFDM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="ofdm_introduction"></a>
Introduction</h1>
<p>GNU Radio provides some blocks to transmit and receive OFDM-modulated signals. In the following, we assume the reader is familiar with OFDM and how it works, for an introduction to OFDM refer to standard textbooks on digital communication.</p>
<p>The blocks are designed in a very generic fashion. As a developer, this means that often, a desired functionality can be achieved by correct parametrization of the available blocks, but in some cases, custom blocks have to be included. The design of the OFDM components is such that adding own functionality is possible with very little friction.</p>
<p><a class="el" href="page_packet_data.html">Packet Data Transmission</a> has an example of how to use OFDM in a packet-based receiver.</p>
<h1><a class="anchor" id="ofdm_conventions"></a>
Conventions and Notations</h1>
<h2><a class="anchor" id="ofdm_fftshift"></a>
FFT Shifting</h2>
<p>In all cases where OFDM symbols are passed between blocks, the default behaviour is to FFT-Shift these symbols, i.e. that the DC carrier is in the middle (to be precise, it is on carrier <img class="formulaInl" alt="$\lfloor N/2 \rfloor$" src="form_0.png"/> where N is the FFT length and carrier indexing starts at 0).</p>
<p>The reason for this convention is that some blocks require FFT-shifted ordering of the symbols to function (such as <a class="el" href="classgr_1_1digital_1_1ofdm__chanest__vcvc.html" title="Estimate channel and coarse frequency offset for OFDM from preamblesInput: OFDM symbols (in frequency...">gr::digital::ofdm_chanest_vcvc</a>), and for consistency's sake, this was chosen as a default for all blocks that pass OFDM symbols. Also, when viewing OFDM symbols, FFT-shifted symbols are in their natural order, i.e. as they appear in the pass band.</p>
<h2><a class="anchor" id="ofdm_indexing"></a>
Carrier Indexing</h2>
<p>Carriers are always index starting at the DC carrier, which has the index 0 (you usually don't want to occupy this carrier). The carriers right of the DC carrier (the ones at higher frequencies) are indexed with 1 through N/2-1 (N being the FFT length again).</p>
<p>The carriers left of the DC carrier (with lower frequencies) can be indexed -N/2 through -1 or N/2 through N-1. Carrier indices N-1 and -1 are thus equivalent. The advantage of using negative carrier indices is that the FFT length can be changed without changing the carrier indexing.</p>
<h2><a class="anchor" id="ofdm_carrieralloc"></a>
Carrier and Symbol Allocation</h2>
<p>Many blocks require knowledge of which carriers are allocated, and whether they carry data or pilot symbols. GNU Radio blocks uses three objects for this, typically called <code>occupied_carriers</code> (for the data symbols), <code>pilot_carriers</code> and <code>pilot_symbols</code> (for the pilot symbols).</p>
<p>Every one of these objects is a vector of vectors. <code>occupied_carriers</code> and <code>pilot_carriers</code> identify the position within a frame where data and pilot symbols are stored, respectively.</p>
<p><code>occupied_carriers</code>[0] identifies which carriers are occupied on the first OFDM symbol, <code>occupied_carriers</code>[1] does the same on the second OFDM symbol etc.</p>
<p>Here's an example: </p>
<div class="fragment"><div class="line">occupied_carriers = ((-2, -1, 1, 3), (-3, -1, 1, 2))</div>
<div class="line">pilot_carriers = ((-3, 2), (-2, 3))</div>
</div><!-- fragment --><p> Every OFDM symbol carries 4 data symbols. On the first OFDM symbol, they are on carriers -2, -1, 1 and 3. Carriers -3 and 2 are not used, so they are where the pilot symbols can be placed. On the second OFDM symbol, the occupied carriers are -3, -1, 1 and 2. The pilot symbols must thus be placed elsewhere, and are put on carriers -2 and 3.</p>
<p>If there are more symbols in the OFDM frame than the length of <code>occupied_carriers</code> or <code>pilot_carriers</code>, they wrap around (in this example, the third OFDM symbol uses the allocation in <code>occupied_carriers</code>[0]).</p>
<p>But how are the pilot symbols set? This is a valid parametrization: </p>
<div class="fragment"><div class="line">pilot_symbols = ((-1, 1j), (1, -1j), (-1, 1j), (-1j, 1))</div>
</div><!-- fragment --><p>The position of these symbols are thos in <code>pilot_carriers</code>. So on the first OFDM symbol, carrier -3 will transmit a -1, and carrier 2 will transmit a 1j. Note that <code>pilot_symbols</code> is longer than <code>pilot_carriers</code> in this example&ndash; this is valid, the symbols in <code>pilot_symbols</code>[2] will be mapped according to <code>pilot_carriers</code>[0].</p>
<h1><a class="anchor" id="ofdm_detectsync"></a>
Detection and Synchronisation</h1>
<p>Before anything happens, an OFDM frame must be detected, the beginning of OFDM symbols must be identified, and frequency offset must be estimated.</p>
<h1><a class="anchor" id="ofdm_tx"></a>
Transmitting</h1>
<div class="image">
<img src="ofdm_tx_core.png" alt="ofdm_tx_core.png"/>
<div class="caption">
Core elements of an OFDM transmitter</div></div>
<p> This image shows a very simple example of a transmitter. It is assumed that the input is a stream of complex scalars with a length tag, i.e. the transmitter will work on one frame at a time.</p>
<p>The first block is the carrier allocator (<a class="el" href="classgr_1_1digital_1_1ofdm__carrier__allocator__cvc.html" title="Create frequency domain OFDM symbols from complex values, add pilots. ">gr::digital::ofdm_carrier_allocator_cvc</a>). This sorts the incoming complex scalars onto OFDM carriers, and also places the pilot symbols onto the correct positions. There is also the option to pass OFDM symbols which are prepended in front of every frame (i.e. preamble symbols). These can be used for detection, synchronisation and channel estimation.</p>
<p>The carrier allocator outputs OFDM symbols (i.e. complex vectors of FFT length). These must be converted to time domain signals before continuing, which is why they are piped into an (I)FFT block. Note that because all the OFDM symbols are treated in the shifted form, the IFFT block must be shifting as well.</p>
<p>Finally, the cyclic prefix is added to the OFDM symbols. The <a class="el" href="classgr_1_1digital_1_1ofdm__cyclic__prefixer.html" title="Adds a cyclic prefix and performs pulse shaping on OFDM symbols. ">gr::digital::ofdm_cyclic_prefixer</a> can also perform pulse shaping on the OFDM symbols (raised cosine flanks in the time domain).</p>
<h1><a class="anchor" id="ofdm_rx"></a>
Receiving</h1>
<p>On the receiver side, some more effort is necessary. The following flow graph assumes that the input starts at the beginning of an OFDM frame and is prepended with a Schmidl &amp; Cox preamble for coarse frequency correction and channel estimation. Also assumed is that the fine frequency offset is already corrected and that the cyclic prefix has been removed. The latter can be achieved by a <a class="el" href="classgr_1_1digital_1_1header__payload__demux.html" title="Header/Payload demuxer (HPD). ">gr::digital::header_payload_demux</a>, the former can be done using a gr::digital::ofdm_sync_sc_cc.</p>
<div class="image">
<img src="ofdm_rx_core.png" alt="ofdm_rx_core.png"/>
<div class="caption">
Core elements of an OFDM receiver</div></div>
<p> First, an FFT shifts the OFDM symbols into the frequency domain, where the signal processing is performed (the OFDM frame is thus in the memory in matrix form). It is passed to a block that uses the preambles to perform channel estimation and coarse frequency offset. Both of these values are added to the output stream as tags; the preambles are then removed from the stream and not propagated.</p>
<p>Note that this block does not correct the OFDM frame. Both the coarse frequency offset correction and the equalizing (using the initial channel state estimate) are done in the following block, <a class="el" href="classgr_1_1digital_1_1ofdm__frame__equalizer__vcvc.html" title="OFDM frame equalizer. ">gr::digital::ofdm_frame_equalizer_vcvc</a>. The interesting property about this block is that it uses a <a class="el" href="classgr_1_1digital_1_1ofdm__equalizer__base.html" title="Base class for implementation details of frequency-domain OFDM equalizers. ">gr::digital::ofdm_equalizer_base</a> derived object to perform the actual equalization.</p>
<p>The last block in the frequency domain is the <a class="el" href="classgr_1_1digital_1_1ofdm__serializer__vcc.html" title="Serializes complex modulations symbols from OFDM sub-carriers. ">gr::digital::ofdm_serializer_vcc</a>, which is the inverse block to the carrier allocator. It plucks the data symbols from the <code>occupied_carriers</code> and outputs them as a stream of complex scalars. These can then be directly converted to bits, or passed to a forward error correction decoder. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
